# Model Comparison {#Chap-03-06-model-comparison}

<hr>

<div style = "float:right; width:40%;">
<img src="visuals/badge-model-comparison.png" alt="badge model comparison">  
</div>  

- AIC
- likelihood ratio test
- Bayes factor

## Snippets / Results

### Bayes factors for ROPE-d hypotheses through encompassing models

Suppose that instead of addressing the point-valued hypothesis $\theta = \theta^*$, we are able (e.g., through prior research or *a priori* conceptual considerations) to specify a reasonable *region of practical equivalence (=ROPE)* around the parameter value of interest and address what we may call the **ROPE-d hypothesis** $\theta \in [\theta^* - \epsilon\ ;\ \theta^* + \epsilon]$, or $\theta = \theta^* \pm \epsilon$ for short.

The Savage-Dickey method can be generalized to cover also interval-valued hypotheses in general, and therefore also ROPE-d hypotheses in particular. The previous literature has focused on inequality-based intervals (like $\theta \ge 0.5$) [@KlugkistKato2005:Bayesian-model-,@WetzelsGrasman2010:An-encompassing,@Oh2014:Bayesian-compar]. Here, we show that this method also extends to arbitrary intervals.

**Theorem statement**

Fix a Bayesian model $M$ with pior $P_M(\theta, \omegs)$ and likelihood function $P_M(D \mid \theta, \omega)$, where $\theta$ is the parameter of interest and $\omega$ is a vector of other (nuisance) parameters. Assume that priors over $\theta$ are independent of the nuisance parameters $\omega$. For an interal-valued hypothesis $H_0$ $\theta \in [a,b]$, the Bayes Factor in favor of this hypothesis over its negation $H_a$ $\theta \not \in [a,b]$ can be expressed as:

$$ \text {BF}_{01} = \frac{\text{posterior-odds of } H_0}{\text{prior-odds of } H_0} $$

**Proof**

```{theorem, "BF-ROPED-hypotheses"}
FILL ME

```

```{proof}
TBD
```

### Example (binomial 24/7)

Using the Savage-Dickey method, the Bayes factor in favor of point-valued hypothesis $\theta = 0.5$ is:

```{r}
bf_point_hypothesis <- dbeta(0.5,8,18) / dunif(0.5, 0, 1)
bf_point_hypothesis
```

Using the ROPE-d method to compute the interval-valued hypothesis $\theta = 0.5 \pm \epsilon$ is:

```{r}
# set the scene
theta_null <- 0.5
epsilon <- 0.01          # epsilon margin for ROPE
upper <- theta_null + epsilon   # upper bound of ROPE
lower <- theta_null - epsilon   # lower bound of ROPE
# calculate prior odds of the ROPE-d hypothesis
prior_of_hypothesis <- qbeta(upper, 1, 1) - qbeta(lower, 1, 1)
prior_odds <- prior_of_hypothesis / (1 - prior_of_hypothesis)
# calculate posterior odds of the ROPE-d hypothesis
posterior_of_hypothesis <- qbeta(upper, 8, 18) - qbeta(lower, 8, 18)
posterior_odds <- posterior_of_hypothesis / (1 - posterior_of_hypothesis)
# calculate Bayes Factor
bf_ROPEd_hypothesis <- posterior_odds / prior_odds
bf_ROPEd_hypothesis
```

