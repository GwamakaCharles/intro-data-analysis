# Data Plotting {#Chap-02-02-visualization}

<hr>

<div style = "float:right; width:45%;">
<img src="visuals/badge-visualization.png" alt="badge-visualization">  
</div>  

Numerical summaries of complex data always incur information loss. Still lossy, but less so (if done well), is visualization. Any serious data analysis should start with a process in which the analyst becomes intimate with the data at hand. Visualization is an integral part of data-intimacy.

Section \@ref(Chap-02-04-Anscombe-example) demonstrates how summary statistics can be misleading and how a simple visualization can be much more revealing.
Section \@ref(Chap-02-04-good-visualization) offers some reflection on what makes a data visualization successful.


```{block, type='infobox'}
The learning goals for this chapter are:

- obtain a basic understanding of better/worse plotting
- be able to produce hypothesis-driven plots of data
- develop a basic understanding of the 'grammar of graphs"
- be able to fine-tune graphs for better visualization

```


## Motivating example: Anscombe's quartet {#Chap-02-04-Anscombe-example}

To see how summary statistics can be highly misleading, and how a simple plot can reveal a lot more, consider a famous dataset available in R [@anscombe1973]: 

```{r}
glimpse(anscombe %>% as_tibble)
```

There are four pairs of $x$ and $y$ coordinates. Unfortunately, these are stored in long format with two pieces of information buried inside of the column name: for instance, the name `x3` contains the information that this column contains the $x$ coordinates for the 3rd pair. This is rather untidy. But, after the last section on data wrangling, we can tidy up quickly:

```{r}
tidy_anscombe <- anscombe %>% as_tibble %>% 
  pivot_longer(
    everything(),                  ## we want o pivot every column
    names_pattern = "(.)(.)",      ## use reg-exps to capture 1st and 2nd character
    names_to = c(".value", "grp")  ## assign names to new cols, using 1st part of
                                   ##   what reg-exp captures as new column names
  ) %>% 
  mutate(grp = paste0("Group ", grp))
tidy_anscombe
```

Here are some summary statistics for each of the four pairs:

```{r}
tidy_anscombe %>% 
  group_by(grp) %>% 
  summarise(
    mean_x    = mean(x),
    mean_y    = mean(y),
    min_x     = min(x),
    min_y     = min(y),
    max_x     = max(x),
    max_y     = max(y),
    r_squared = cor(x,y)^2
  )
```

<!-- EXERCISE: make the index the new column names instead -->

These numeric indicators suggest that each pair of $x$ and $y$ values is very similar. Only the ranges seem to differ. A brilliant example of how misleading numeric statistics can be, as compared to a plot of the data:

```{r ch-02-anscombe, fig.cap="Anscombe's Quartet: four different data sets all of which receive the same correlation score."}
tidy_anscombe %>% 
  ggplot(aes(x, y)) +
    geom_smooth(method = lm, se = F, color = "black") +
    geom_point(color = project_colors[3], size = 2) +
    scale_y_continuous(breaks = scales::pretty_breaks()) +
    scale_x_continuous(breaks = scales::pretty_breaks()) +
    labs(title = "Anscombe's Quartet", x = NULL, y = NULL,
         subtitle = bquote(y == 0.5 * x + 3 ~ (R^2 %~~% .667) ~ "for all datasets")) +
    facet_wrap(~grp, ncol = 2, scales = "free_x") +
    theme(strip.background = element_rect(fill = "#f2f2f2", colour = "white"))
```

<!-- for exercise check out the work of Jan Verhove: -->
<!-- https://janhove.github.io/teaching/2016/11/21/what-correlations-look-like -->


## Visualization: the good, the bad and the ugly {#Chap-02-04-good-visualization}

- often voiced rule is "minimize ink, maximize information"
- It is unclear why ink is so important, but the ease with which a viewer is able to retrieve the relevant information most certainly is.

```{block, type='infobox'}
**The vague & defeasible rule of thump of good data visualization (according to the author).**

"Mimize observer effort to obtain a maximal degree of relevant true information."

```

- we need conventions for communication

Bad examples:

- super long bars
- pie charts (BLJM)
- rectangle plots
- 3D Plots

Figure \@ref(fig:chap-02-04-bar-plot-3d-BLJM) does actually show the relevant information but is entirely useless for a human observer without a magnifying glass, professional measuring tools and a calculator.

```{r chap-02-04-bar-plot-3d-BLJM, echo = F, fig.cap="Example of a frontrunner for the prize of today's most complete disaster in the visual communication of information."}
knitr::include_graphics("visuals/bar-plot-3D-BLJM.png")
```


Subjectively, Figure \@ref(fig:chap-02-04-pie-chart-BLJM) is pretty much anything but pretty. Objectively, it is not useful for answering the question which we care about, namely whether logicians are more likely to prefer Jazz over Metal than biologists.

```{r chap-02-04-pie-chart-BLJM, echo = F, fig.cap="Example of a rather unhelpful visual representation of the BLJM data (when the research question is whether logicians are more likely to prefer Jazz over Metal than biologists)."}
knitr::include_graphics("visuals/pie-chart-BLJM.png")
```

We can produce a much more useful representation with the code below. (A similar visualization also appeared as Figure \@ref(fig:chap-02-03-BLJM-proportions) in the previous chapter.)

```{r chap-02-04-BLJM-proportions, echo = T}
BLJM_associated_counts %>% 
  ggplot(
    aes(
      x = LB, 
      y = n, 
      color = JM, 
      shape = JM, 
      group = JM
    )
  ) +
  geom_point(size = 3) + geom_line() +
  labs(
    title = "Counts of choices of each music+subject pair",
    x = "",
    y = ""
  )
```

## Basic kinds of plots 

### 

## The gramar of graphs

## Full example: Plotting for 'Mental Chronometry'

```{r}
# read a data set of reaction times (as a tibble)
# RTs <- read_csv("https://tinyurl.com/y4jo8mox")
RTs <- read_csv("data_sets/ch-03-set-01-MC-RTs.csv")

# check its content
glimpse(RTs)
```
