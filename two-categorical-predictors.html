<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.1 Two categorical predictors | Introduction to Data Analysis</title>
  <meta name="description" content="Course Material for I2DA-2019 in Cognitive Science at University Osnabrück" />
  <meta name="generator" content="bookdown 0.17.2 and GitBook 2.6.7" />

  <meta property="og:title" content="4.1 Two categorical predictors | Introduction to Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course Material for I2DA-2019 in Cognitive Science at University Osnabrück" />
  <meta name="github-repo" content="michael-franke/intro-data-analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.1 Two categorical predictors | Introduction to Data Analysis" />
  
  <meta name="twitter:description" content="Course Material for I2DA-2019 in Cognitive Science at University Osnabrück" />
  

<meta name="author" content="Michael Franke" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Chap-04-02-beyond-simple-regression.html"/>
<link rel="next" href="app-90-further-material.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!--<link rel="stylesheet" href="https://s3-us-west-2.amazonaws.com/cdn.webppl.org/webppl-editor-1.0.9.css">-->
<link rel="stylesheet" href="https://s3-us-west-2.amazonaws.com/cdn.webppl.org/webppl-viz-0.7.11.css">

<script src="https://s3-us-west-2.amazonaws.com/cdn.webppl.org/webppl-editor-1.0.9.js"></script>
<script src="https://s3-us-west-2.amazonaws.com/cdn.webppl.org/webppl-viz-0.7.11.js"></script>
<script src="https://s3-us-west-2.amazonaws.com/cdn.webppl.org/webppl-v0.9.13.js" defer async></script>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
<link rel="stylesheet" href="webppl-editor.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Preliminaries</b></span></li>
<li class="chapter" data-level="1" data-path="general-introduction.html"><a href="general-introduction.html"><i class="fa fa-check"></i><b>1</b> General Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="Chap-01-00-intro-learning-goals.html"><a href="Chap-01-00-intro-learning-goals.html"><i class="fa fa-check"></i><b>1.1</b> Learning goals</a></li>
<li class="chapter" data-level="1.2" data-path="Chap-01-00-intro-course-structure.html"><a href="Chap-01-00-intro-course-structure.html"><i class="fa fa-check"></i><b>1.2</b> Course structure</a></li>
<li class="chapter" data-level="1.3" data-path="Chap-01-00-intro-tools-methods.html"><a href="Chap-01-00-intro-tools-methods.html"><i class="fa fa-check"></i><b>1.3</b> Tools and topics covered (and not covered) here</a></li>
<li class="chapter" data-level="1.4" data-path="Chap-01-00-intro-data-sets.html"><a href="Chap-01-00-intro-data-sets.html"><i class="fa fa-check"></i><b>1.4</b> Data sets covered</a></li>
<li class="chapter" data-level="1.5" data-path="Chap-01-00-intro-installation.html"><a href="Chap-01-00-intro-installation.html"><i class="fa fa-check"></i><b>1.5</b> Installation</a><ul>
<li class="chapter" data-level="1.5.1" data-path="Chap-01-00-intro-installation.html"><a href="Chap-01-00-intro-installation.html#Chap-01-00-intro-installation-VirtualBox"><i class="fa fa-check"></i><b>1.5.1</b> VirtualBox Setup</a></li>
<li class="chapter" data-level="1.5.2" data-path="Chap-01-00-intro-installation.html"><a href="Chap-01-00-intro-installation.html#Chap-01-00-intro-installation-Manual"><i class="fa fa-check"></i><b>1.5.2</b> Manual installation</a></li>
<li class="chapter" data-level="1.5.3" data-path="Chap-01-00-intro-installation.html"><a href="Chap-01-00-intro-installation.html#Chap-01-00-intro-installation-Updating"><i class="fa fa-check"></i><b>1.5.3</b> Updating the course package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Chap-01-01-R.html"><a href="Chap-01-01-R.html"><i class="fa fa-check"></i><b>2</b> Basics of R</a><ul>
<li class="chapter" data-level="2.1" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html"><i class="fa fa-check"></i><b>2.1</b> First steps</a><ul>
<li class="chapter" data-level="2.1.1" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html#functions"><i class="fa fa-check"></i><b>2.1.1</b> Functions</a></li>
<li class="chapter" data-level="2.1.2" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html#variables"><i class="fa fa-check"></i><b>2.1.2</b> Variables</a></li>
<li class="chapter" data-level="2.1.3" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html#literate-coding"><i class="fa fa-check"></i><b>2.1.3</b> Literate coding</a></li>
<li class="chapter" data-level="2.1.4" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html#objects"><i class="fa fa-check"></i><b>2.1.4</b> Objects</a></li>
<li class="chapter" data-level="2.1.5" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html#packages"><i class="fa fa-check"></i><b>2.1.5</b> Packages</a></li>
<li class="chapter" data-level="2.1.6" data-path="ch1-first-steps.html"><a href="ch1-first-steps.html#Chap-01-01-R-help"><i class="fa fa-check"></i><b>2.1.6</b> Getting help</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="ch1-data-types.html"><a href="ch1-data-types.html"><i class="fa fa-check"></i><b>2.2</b> Data types</a><ul>
<li class="chapter" data-level="2.2.1" data-path="ch1-data-types.html"><a href="ch1-data-types.html#numeric-vectors-matrices"><i class="fa fa-check"></i><b>2.2.1</b> Numeric vectors &amp; matrices</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch1-data-types.html"><a href="ch1-data-types.html#booleans"><i class="fa fa-check"></i><b>2.2.2</b> Booleans</a></li>
<li class="chapter" data-level="2.2.3" data-path="ch1-data-types.html"><a href="ch1-data-types.html#special-values"><i class="fa fa-check"></i><b>2.2.3</b> Special values</a></li>
<li class="chapter" data-level="2.2.4" data-path="ch1-data-types.html"><a href="ch1-data-types.html#characters-strings"><i class="fa fa-check"></i><b>2.2.4</b> Characters (= strings)</a></li>
<li class="chapter" data-level="2.2.5" data-path="ch1-data-types.html"><a href="ch1-data-types.html#factors"><i class="fa fa-check"></i><b>2.2.5</b> Factors</a></li>
<li class="chapter" data-level="2.2.6" data-path="ch1-data-types.html"><a href="ch1-data-types.html#lists-data-frames-tibbles"><i class="fa fa-check"></i><b>2.2.6</b> Lists, data frames &amp; tibbles</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="Chap-01-01-functions.html"><a href="Chap-01-01-functions.html"><i class="fa fa-check"></i><b>2.3</b> Functions</a><ul>
<li class="chapter" data-level="2.3.1" data-path="Chap-01-01-functions.html"><a href="Chap-01-01-functions.html#some-important-built-in-functions"><i class="fa fa-check"></i><b>2.3.1</b> Some important built-in functions</a></li>
<li class="chapter" data-level="2.3.2" data-path="Chap-01-01-functions.html"><a href="Chap-01-01-functions.html#defining-your-own-functions"><i class="fa fa-check"></i><b>2.3.2</b> Defining your own functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ch-01-01-loops-and-maps.html"><a href="ch-01-01-loops-and-maps.html"><i class="fa fa-check"></i><b>2.4</b> Loops and maps</a></li>
<li class="chapter" data-level="2.5" data-path="Chap-01-01-piping.html"><a href="Chap-01-01-piping.html"><i class="fa fa-check"></i><b>2.5</b> Piping</a></li>
<li class="chapter" data-level="2.6" data-path="ch-01-01-Rmarkdown.html"><a href="ch-01-01-Rmarkdown.html"><i class="fa fa-check"></i><b>2.6</b> Rmarkdown</a></li>
</ul></li>
<li class="part"><span><b>II Appliied (generalized) linear modeling</b></span></li>
<li class="chapter" data-level="3" data-path="Chap-04-01-simple-linear-regression.html"><a href="Chap-04-01-simple-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Simple linear regression</a><ul>
<li class="chapter" data-level="3.1" data-path="data-set-murder-data.html"><a href="data-set-murder-data.html"><i class="fa fa-check"></i><b>3.1</b> Data set: murder data</a></li>
<li class="chapter" data-level="3.2" data-path="what-is-a-simple-linear-regression.html"><a href="what-is-a-simple-linear-regression.html"><i class="fa fa-check"></i><b>3.2</b> What is a (simple) linear regression?</a><ul>
<li class="chapter" data-level="3.2.1" data-path="what-is-a-simple-linear-regression.html"><a href="what-is-a-simple-linear-regression.html#prediction-without-any-further-information"><i class="fa fa-check"></i><b>3.2.1</b> Prediction without any further information</a></li>
<li class="chapter" data-level="3.2.2" data-path="what-is-a-simple-linear-regression.html"><a href="what-is-a-simple-linear-regression.html#prediction-with-knowledge-of-unemployment-rate"><i class="fa fa-check"></i><b>3.2.2</b> Prediction with knowledge of unemployment rate</a></li>
<li class="chapter" data-level="3.2.3" data-path="what-is-a-simple-linear-regression.html"><a href="what-is-a-simple-linear-regression.html#simple-linear-regression-general-problem-formulation"><i class="fa fa-check"></i><b>3.2.3</b> Simple linear regression: general problem formulation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ordinary-least-squares-regression.html"><a href="ordinary-least-squares-regression.html"><i class="fa fa-check"></i><b>3.3</b> Ordinary least-squares regression</a><ul>
<li class="chapter" data-level="3.3.1" data-path="ordinary-least-squares-regression.html"><a href="ordinary-least-squares-regression.html#finding-optimal-parameters-with-optim"><i class="fa fa-check"></i><b>3.3.1</b> Finding optimal parameters with <code>optim</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="ordinary-least-squares-regression.html"><a href="ordinary-least-squares-regression.html#fitting-ols-regression-lines-with-lm"><i class="fa fa-check"></i><b>3.3.2</b> Fitting OLS regression lines with <code>lm</code></a></li>
<li class="chapter" data-level="3.3.3" data-path="ordinary-least-squares-regression.html"><a href="ordinary-least-squares-regression.html#finding-optimal-parameter-values-with-math"><i class="fa fa-check"></i><b>3.3.3</b> Finding optimal parameter values with math</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="a-maximum-likelihood-approach.html"><a href="a-maximum-likelihood-approach.html"><i class="fa fa-check"></i><b>3.4</b> A maximum-likelihood approach</a></li>
<li class="chapter" data-level="3.5" data-path="a-bayesian-approach.html"><a href="a-bayesian-approach.html"><i class="fa fa-check"></i><b>3.5</b> A Bayesian approach</a><ul>
<li class="chapter" data-level="3.5.1" data-path="a-bayesian-approach.html"><a href="a-bayesian-approach.html#implementation-in-greta"><i class="fa fa-check"></i><b>3.5.1</b> Implementation in <code>greta</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="a-bayesian-approach.html"><a href="a-bayesian-approach.html#using-the-brms-package"><i class="fa fa-check"></i><b>3.5.2</b> Using the <code>brms</code> package</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="testing-coefficients.html"><a href="testing-coefficients.html"><i class="fa fa-check"></i><b>3.6</b> Testing coefficients</a><ul>
<li class="chapter" data-level="3.6.1" data-path="testing-coefficients.html"><a href="testing-coefficients.html#bayesian-approach"><i class="fa fa-check"></i><b>3.6.1</b> Bayesian approach</a></li>
<li class="chapter" data-level="3.6.2" data-path="testing-coefficients.html"><a href="testing-coefficients.html#frequentist-approach"><i class="fa fa-check"></i><b>3.6.2</b> Frequentist approach</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Chap-04-02-beyond-simple-regression.html"><a href="Chap-04-02-beyond-simple-regression.html"><i class="fa fa-check"></i><b>4</b> Beyond simple linear regression</a><ul>
<li class="chapter" data-level="4.1" data-path="two-categorical-predictors.html"><a href="two-categorical-predictors.html"><i class="fa fa-check"></i><b>4.1</b> Two categorical predictors</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="app-90-further-material.html"><a href="app-90-further-material.html"><i class="fa fa-check"></i><b>A</b> Further useful material</a><ul>
<li class="chapter" data-level="A.1" data-path="material-on-introduction-to-probability.html"><a href="material-on-introduction-to-probability.html"><i class="fa fa-check"></i><b>A.1</b> Material on <em>Introduction to Probability</em>:</a></li>
<li class="chapter" data-level="A.2" data-path="material-on-bayesian-data-analysis.html"><a href="material-on-bayesian-data-analysis.html"><i class="fa fa-check"></i><b>A.2</b> Material on <em>Bayesian Data Analysis</em>:</a></li>
<li class="chapter" data-level="A.3" data-path="material-on-frequentist-statistics.html"><a href="material-on-frequentist-statistics.html"><i class="fa fa-check"></i><b>A.3</b> Material on <em>frequentist statistics</em>:</a></li>
<li class="chapter" data-level="A.4" data-path="material-on-r-tidyverse-etc-.html"><a href="material-on-r-tidyverse-etc-.html"><i class="fa fa-check"></i><b>A.4</b> Material on <em>R, tidyverse, etc.</em>:</a></li>
<li class="chapter" data-level="A.5" data-path="further-information-for-rstudio.html"><a href="further-information-for-rstudio.html"><i class="fa fa-check"></i><b>A.5</b> Further information for RStudio</a></li>
<li class="chapter" data-level="A.6" data-path="resources-on-webppl.html"><a href="resources-on-webppl.html"><i class="fa fa-check"></i><b>A.6</b> Resources on WebPPL</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="two-categorical-predictors" class="section level2">
<h2><span class="header-section-number">4.1</span> Two categorical predictors</h2>
<p>Let’s revisit the (fictitious) eco-sensitivity data from Chapter <a href="#ch-03-07-hypothesis-testing-Bayes"><strong>??</strong></a>:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" data-line-number="1">x_A &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb178-2" data-line-number="2">  <span class="dv">104</span>, <span class="dv">105</span>, <span class="dv">100</span>, <span class="dv">91</span>, <span class="dv">105</span>, <span class="dv">118</span>, <span class="dv">164</span>, <span class="dv">168</span>, <span class="dv">111</span>, <span class="dv">107</span>, <span class="dv">136</span>, <span class="dv">149</span>, <span class="dv">104</span>, <span class="dv">114</span>, <span class="dv">107</span>, <span class="dv">95</span>, </a>
<a class="sourceLine" id="cb178-3" data-line-number="3">  <span class="dv">83</span>, <span class="dv">114</span>, <span class="dv">171</span>, <span class="dv">176</span>, <span class="dv">117</span>, <span class="dv">107</span>, <span class="dv">108</span>, <span class="dv">107</span>, <span class="dv">119</span>, <span class="dv">126</span>, <span class="dv">105</span>, <span class="dv">119</span>, <span class="dv">107</span>, <span class="dv">131</span></a>
<a class="sourceLine" id="cb178-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb178-5" data-line-number="5">x_B &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb178-6" data-line-number="6">  <span class="dv">133</span>, <span class="dv">115</span>, <span class="dv">84</span>, <span class="dv">79</span>, <span class="dv">127</span>, <span class="dv">103</span>, <span class="dv">109</span>, <span class="dv">128</span>, <span class="dv">127</span>, <span class="dv">107</span>, <span class="dv">94</span>, <span class="dv">95</span>, <span class="dv">90</span>, <span class="dv">118</span>, <span class="dv">124</span>, <span class="dv">108</span>, </a>
<a class="sourceLine" id="cb178-7" data-line-number="7">  <span class="dv">87</span>, <span class="dv">111</span>, <span class="dv">96</span>, <span class="dv">89</span>, <span class="dv">106</span>, <span class="dv">121</span>, <span class="dv">99</span>, <span class="dv">86</span>, <span class="dv">115</span>, <span class="dv">136</span>, <span class="dv">114</span></a>
<a class="sourceLine" id="cb178-8" data-line-number="8">)</a></code></pre></div>
<p>Remember that we are interested in the question whether there is a difference in means of group A and group B. Previously we used a <span class="math inline">\(t\)</span>-test for this two-group comparison (frequentist or Bayesian). But we can also cast this as a regression problem. Here is how.</p>
<p>Let’s first squeeze the data into a tibble:</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" data-line-number="1">eco_sensitivity_data &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb179-2" data-line-number="2">  <span class="dt">group =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="kw">length</span>(x_A)), <span class="kw">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="kw">length</span>(x_B))),</a>
<a class="sourceLine" id="cb179-3" data-line-number="3">  <span class="dt">measurement =</span> <span class="kw">c</span>(x_A, x_B)</a>
<a class="sourceLine" id="cb179-4" data-line-number="4">) </a>
<a class="sourceLine" id="cb179-5" data-line-number="5">eco_sensitivity_data</a></code></pre></div>
<pre><code>## # A tibble: 57 x 2
##    group measurement
##    &lt;chr&gt;       &lt;dbl&gt;
##  1 A             104
##  2 A             105
##  3 A             100
##  4 A              91
##  5 A             105
##  6 A             118
##  7 A             164
##  8 A             168
##  9 A             111
## 10 A             107
## # … with 47 more rows</code></pre>
<p>Notice that this tibble contains the data in a tidy format, i.e., each row contains a tuple of associated measurements. We want to explain or predict the variable <code>measurement</code> in terms of the variable <code>group</code>.We can then run a regression model with forumla <code>measurement ~ group</code>. Here’s such a model using the Bayesian approach:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" data-line-number="1">fit_brms_eco_sensitivity &lt;-<span class="st"> </span><span class="kw">brm</span>(</a>
<a class="sourceLine" id="cb181-2" data-line-number="2">  <span class="co"># specify what to explain in terms of what</span></a>
<a class="sourceLine" id="cb181-3" data-line-number="3">  <span class="co">#  using the formula syntax</span></a>
<a class="sourceLine" id="cb181-4" data-line-number="4">  <span class="dt">formula =</span> measurement <span class="op">~</span><span class="st"> </span>group,</a>
<a class="sourceLine" id="cb181-5" data-line-number="5">  <span class="co"># which data to use</span></a>
<a class="sourceLine" id="cb181-6" data-line-number="6">  <span class="dt">data =</span> eco_sensitivity_data</a>
<a class="sourceLine" id="cb181-7" data-line-number="7">)</a></code></pre></div>
<p>Let’s inspect the summary information for the posterior samples:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" data-line-number="1"><span class="co"># just showing information for the so-called &#39;fixed effects&#39;</span></a>
<a class="sourceLine" id="cb182-2" data-line-number="2"><span class="kw">summary</span>(fit_brms_eco_sensitivity)<span class="op">$</span>fixed </a></code></pre></div>
<pre><code>##            Estimate Est.Error  l-95% CI    u-95% CI     Rhat Bulk_ESS Tail_ESS
## Intercept 118.68533  3.755572 111.42867 125.8595713 1.001581     3956     3160
## groupB    -11.37756  5.576870 -22.47929  -0.6354608 1.001299     3845     2694</code></pre>
<p>Compare this with the summary of the posterior estimates we obtained from the Bayesian <span class="math inline">\(t\)</span>-test model for this data which we implemented in <code>greta</code> and ran in Chapter <a href="#ch-03-07-hypothesis-testing-Bayes"><strong>??</strong></a>.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" data-line-number="1">Bayes_estimates_eco</a></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   Parameter `|95%`  mean `95|%`
##   &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1 delta      -21.0 -10.9 -0.384</code></pre>
<p>The mean of the <span class="math inline">\(\delta\)</span> parameter looks suscpiciously similar to the ominous <code>groupB</code> parameter shown in the output of the <code>bmrs</code> model fit. The 95% HDIs of the estimated posterior for the <span class="math inline">\(\delta\)</span> parameter also look suspiciously like the values of the 95% interquantile range for the <code>groupB</code> parameter. This is no conincidence! In fact, the regression model that <code>bmrs</code> calculates here is essentially the same as the <span class="math inline">\(t\)</span>-test model we implemented in <code>greta</code> by hand except for slight different in the choice of the priors and inessential differences in mathematical formulation of the group mean comparison.</p>
<ul>
<li>show plots of posterior side-by-side</li>
<li>spell out models, show graphs</li>
</ul>
<p>The upshot is, that we can conceive of a <span class="math inline">\(t\)</span>-test as a special case of a linear regression model!</p>

<!-- # Logistic regression -->
<!-- ### Beta-Binomial model - one group (revisited) -->
<!-- Sofar the existence of the underlying probability $\theta$ for observing head as outcome of a coin flip has been discussed. But the estimation of $\theta$ has been ignored until yet. Although "estimation" will be topic of next chapter, it is helpful at this point to discuss the introduced models further. In order to estimate $\theta$ *parameter(s)* are needed. When it comes to estimation exactly this/these parameter(s) will be the result(s), therefore is is important to see already the connection to the models that were developed in this chapter. -->
<!-- For the coin flip example the value of interest is the underlying probability, thus, only one parameter is needed:$\beta_0$. (Note: Latin letters are used when we refer to the sample, Greek letters are used when we refer to the population.) -->
<!-- How is $\beta_0$ linked to the latent variable $\theta$? -->
<!-- Considering for example the simplest case: a *linear relationship* (see next plot left side). The problem which arises at this point is that $\theta$ represents a probability, and is therefore bounded to the range 0-1 (grey shaded area). -->
<!-- ```{r} -->
<!-- #Different relationships between the parameter and expected value -->
<!-- x <- seq(from=-4, to=4, length.out = 100) -->
<!-- y <- x                 #linear relationship -->
<!-- y.log <- inv_logit_scaled(x)   #logistic relationship -->
<!-- par(mfrow = c(1, 2))   #set both plot beside each other -->
<!-- plot(x, y, type="l", ylab=expression(theta), xlab=expression(beta[0])) -->
<!-- rect(-5, 0, 5, 1, col = rgb(0.5, 0.5, 0.5, 1/4), border = NA) -->
<!-- plot(x, y.log, type="l", ylab=expression(logit~(theta)), xlab=expression(beta[0])) -->
<!-- rect(-5, 0, 5, 1, col = rgb(0.5, 0.5, 0.5, 1/4), border = NA) -->
<!-- ``` -->
<!-- A mathematical transformation is needed such that the parameter $\beta_0$ can take any value while $\theta$ is bounded to the range 0-1. One transformation that offers exactly this possibility is the *logit link function* (see above plot right side) -->
<!-- $$logit(\theta) = \beta_0.$$ -->
<!-- As the underlying assumption maps the parameter to the latent variable $\theta$ (and not the other way around) from a conceptional point of view the *inverse link function* is more appropriate, which is the *logistic link* in this case: -->
<!-- $$\theta = logistic(\beta_0).$$ -->
<!-- It is defined as -->
<!-- $$\theta=\frac{exp(\beta_0)}{1+exp(\beta_0)}.$$ -->
<!-- Both expression, *logit* and *logistic* link achieve mathematically the same result but it is conceptually just a different matter of emphasis [@kruschke2015]. -->
<!-- #### Notation of beta-binomial model - one group (revisited) -->
<!-- The current descriptive model incorporates the idea that parameter $\beta_0$ is estimated from the given sample. It defines the latent variable $\theta$. The parameter is mapped to $\theta$ by a logistic link function. The underlying probability $\theta$ designates the observed number of upcoming heads. The number of upcoming heads in turn, is assumed to be distributed as Binomial distribution. -->
<!-- <!-- [here graphical notation including textual notation... but I don't know how to write it properly down... what is the right order????] -->
<p>–&gt;</p>
<!-- ### Beta-Binomial model - two groups (revisited) -->
<!-- In the above model for two coins the latent variable $\delta$ was already introduced. It is defined by the difference between the underlying probabilities $\theta_1-\theta_2$. -->
<!-- Which parameters should be used in order to estimate the difference between both groups? As we will see, it turns out that the same mathematical form can be used, as one would use for simple linear regression: -->
<!-- $$\theta_j=\beta_0+\beta_1*X_{Group_j},$$ -->
<!-- $$\textrm{with } X_{Group_j}=\begin{cases} -->
<!-- 0, \textrm{if coin 2,}\\ -->
<!-- 1, \textrm{if coin 1.} -->
<!-- \end{cases}$$ -->
<!-- Considering *coin 2*, the above equation would result in -->
<!-- $$\theta_2 = \beta_0,$$ -->
<!-- which is the *intercept* and indicates the proportion of head coming up for coin 2. -->
<!-- Considering by contrast coin 1, then the equation would result in: -->
<!-- $$\theta_1 = \beta_0 + \beta_1.$$ -->
<!-- The proportion of coming up head for coin 1 has to be calculated by summing up the *intercept* $\beta_0$ and the *slope* $\beta_1$. -->
<!-- Taken together: *What is the interpretation of the slope $\beta_1$?* -->
<!-- The difference $\delta=\theta_1-\theta2$ is -->
<!-- $$\theta_1 - \theta_2 = (\beta_0+\beta_1)-\beta_0=\beta_1=\delta,$$ -->
<!-- the slope $\beta_1$, thus, we can see that this parameterization enables us to estimate the difference between two groups. When in comes to estimation and interpretation the results will be the intercept $b_0$ and the slope $b_1$. -->
<!-- ### Simple linear regression model (revisited) -->

<!-- # Multinomial regression -->
<!-- todo -->

<!-- # Ordinal regression -->
<!-- todo -->

<!-- # Hierarchical regression {#ch-05-05-hierarchical-modeling} -->
<!-- todo  -->

</div>
<!-- </div> -->



            </section>

          </div>
        </div>
      </div>
<a href="Chap-04-02-beyond-simple-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="app-90-further-material.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["I2DA.epub", "I2DA.pdf"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
